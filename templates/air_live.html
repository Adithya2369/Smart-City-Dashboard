{% extends "base.html" %}
{% block content %}
  <div class="grid">
    <div class="card col-12" style="display:flex; align-items:center; justify-content:space-between;">
      <div>
        <h3 style="margin:0; color:var(--accent-1);">Air Quality — Live</h3>
        <div class="tiny">Auto-refreshes every 20 seconds</div>
      </div>
      <div>
        <a class="btn" href="{{ url_for('air_history') }}">View History</a>
      </div>
    </div>

    {% if not live %}
      <div class="card col-12 empty">No air quality data available.</div>
    {% else %}
      <div class="card col-3">
        <div class="stat-title">AQI</div>
        <div class="stat-val">{{ live.get('AQI') or live.get('AQI ') or 'N/A' }}</div>
        <div class="muted-small">Air Quality Index</div>
      </div>

      <div class="card col-3">
        <div class="stat-title">CO₂ (ppm)</div>
        <div class="stat-val">{{ live.get('CO2') or live.get('CO₂') or 'N/A' }}</div>
        <div class="muted-small">Carbon dioxide</div>
      </div>

      <div class="card col-3">
        <div class="stat-title">PM2.5 (µg/m³)</div>
        <div class="stat-val">{{ live.get('PM2_5') or live.get('PM2.5') or 'N/A' }}</div>
        <div class="muted-small">Fine particulate matter</div>
      </div>

      <div class="card col-3">
        <div class="stat-title">PM10 (µg/m³)</div>
        <div class="stat-val">{{ live.get('PM10') or 'N/A' }}</div>
        <div class="muted-small">Coarse particulate matter</div>
      </div>

      <div class="card col-12" style="margin-top:8px;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <div class="tiny">Timestamp: {{ live.get('Timestamp') or live.get('Time') or 'N/A' }}</div>
          <div class="tiny">Source: Google Sheets (AirQuality)</div>
        </div>
      </div>
    {% endif %}
  </div>
{% endblock %}

{% block scripts %}
<script>
    // Auto refresh every 20 seconds
    setTimeout(function(){
        location.reload();
    }, 20000);
</script>
{% endblock %}
